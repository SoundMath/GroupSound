clear;
n=8;
nn=n*n;
nn2=2*nn;
rt3=sqrt(3);
w=exp(-2*pi*i/3);
w2=w*w;
m=nn*3;
b=zeros(m,m);
c=conj(fft(eye(n,n)));
cc=kron(c,c);
b(1:nn,1:nn)=cc;
b(nn+1:nn2,nn+1:nn2)=cc;
b(nn2+1:m,nn2+1:m)=cc;
b(1,:)=1.0;
b(nn+1,1:nn)=1.0;
b(nn+1,nn+1:nn2)=w;
b(nn+1,nn2+1:m)=w2;
b(nn2+1,1:nn)=1.0;
b(nn2+1,nn+1:nn2)=w2;
b(nn2+1,nn2+1:m)=w;
b(1,:)=(1/rt3)*b(1,:);
b(nn+1,:)=(1/rt3)*b(nn+1,:);
b(nn2+1,:)=(1/rt3)*b(nn2+1,:);
b=(1/n)*b;