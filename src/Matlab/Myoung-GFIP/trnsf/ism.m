clear;
sc=1/(sqrt(2));
e2=eye(2,2);
e4=eye(4,4);
f2=sqrt(2)*ifft(e2);
aa=kron(f2,f2);
sc=1/sqrt(2);
%
u1=zeros(8,8);
u1(1,1:8)=sc*[aa(1,1:4) aa(1,1:4)];
u1(2,1:4)=aa(2,1:4);
u1(3,1:4)=aa(3,1:4);
u1(4,1:8)=sc*[aa(4,1:4) aa(4,1:4)];
u1(5,1:8)=sc*[aa(1,1:4) -aa(1,1:4)];
u1(6,5:8)=aa(2,1:4);
u1(7,5:8)=aa(3,1:4);
u1(8,1:8)=sc*[aa(4,1:4) -aa(4,1:4)];
%
u1_1=u1;
u1_2=u1_1*u1_1;
u1_3=u1_2*u1_1;
u1_4=u1_3*u1_1;
%
f4=2*ifft(e4);
u2=zeros(8,8);
u2(1,1:8)=sc*[f4(1,1:4) f4(1,1:4)];
u2(2,1:4)=f4(2,1:4);
u2(3,1:8)=sc*[f4(3,1:4) f4(3,1:4)];
u2(4,1:4)=f4(4,1:4);
u2(5,1:8)=sc*[f4(1,1:4) -f4(1,1:4)];
u2(6,5:8)=f4(2,1:4);
u2(7,1:8)=sc*[f4(3,1:4) -f4(3,1:4)];
u2(8,5:8)=f4(4,1:4);
u2_1=u2;
u2_2=u2_1*u2_1;
u2_3=u2_2*u2_1;
u2_4=u2_3*u2_1;
%
u12=u1*u2;
u21=u2*u1;
q(:,1)= e4(:,1);
q(:,2)= e4(:,3);
q(:,3)= e4(:,2);
q(:,4)= e4(:,4);
qq=kron(e2,q);
%
ff=f2*[1 0;0 i];
ab=.5*[1+i 1-i;1-i 1+i]*f2;
%
T=e4;
T(4,4)=i;
chk1=q*kron(e2,f2)*T*kron(f2,e2);
R=e4;
R(3:4,3:4)=.5*[1+i 1-i;1-i 1+i];
chk2=q*R*kron(e2,f2)*kron(f2,e2);
chk3=kron(f2,e2)*kron(e2,f2)*R*q;
%
